<!--pages/order/order.wxml-->
<view class="container">
  <!-- å¤´éƒ¨æ ‡é¢˜ -->
  <view class="header">
    <view class="shop-name">ğŸµ èŒ¶è¯­å ‚</view>
    <view class="shop-subtitle">äº¬è¥¿æ™ºè°·ç²¾å“èŒ¶é¥®</view>
  </view>

  <!-- åˆ†ç±»å¯¼èˆª -->
  <view class="category-nav">
    <scroll-view scroll-x="true" class="category-scroll">
      <view class="category-list">
        <view 
          class="category-item {{item.active ? 'active' : ''}}"
          wx:for="{{categories}}"
          wx:key="id"
          data-id="{{item.id}}"
          bindtap="switchCategory">
          {{item.name}}
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- å•†å“åˆ—è¡¨ -->
  <view class="products-section">
    <view class="product-grid">
      <view 
        class="product-card"
        wx:for="{{products}}"
        wx:key="id"
        wx:if="{{item.categoryId === currentCategory || currentCategory === 0}}">
        
        <!-- çƒ­é”€æ ‡ç­¾ -->
        <view class="hot-tag" wx:if="{{item.hot}}">ğŸ”¥</view>
        
        <!-- å•†å“å›¾ç‰‡ -->
        <view class="product-image-wrapper">
          <image src="{{item.image}}" class="product-image" mode="aspectFill"></image>
        </view>
        
        <!-- å•†å“ä¿¡æ¯ -->
        <view class="product-info">
          <view class="product-name">{{item.name}}</view>
          <view class="product-description">{{item.description}}</view>
          <view class="product-footer">
            <view class="product-price">Â¥{{item.price}}</view>
            <button 
              class="add-btn"
              data-id="{{item.id}}"
              bindtap="addToCart">
              +
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- è´­ç‰©è½¦æµ®åŠ¨æŒ‰é’® -->
  <view class="cart-float-btn" wx:if="{{totalCount > 0}}" bindtap="showCartModal">
    <view class="cart-icon">ğŸ›’</view>
    <view class="cart-count">{{totalCount}}</view>
    <view class="cart-amount">Â¥{{totalAmount}}</view>
  </view>
</view>

<!-- è´­ç‰©è½¦æ¨¡æ€æ¡† -->
<view class="cart-modal" wx:if="{{showCart}}">
  <view class="cart-overlay" bindtap="hideCartModal"></view>
  <view class="cart-content">
    <!-- è´­ç‰©è½¦å¤´éƒ¨ -->
    <view class="cart-header">
      <view class="cart-title">è´­ç‰©è½¦ ({{totalCount}})</view>
      <view class="cart-actions">
        <button class="clear-btn" bindtap="clearCart">æ¸…ç©º</button>
        <button class="close-btn" bindtap="hideCartModal">âœ•</button>
      </view>
    </view>

    <!-- è´­ç‰©è½¦å•†å“åˆ—è¡¨ -->
    <scroll-view scroll-y class="cart-list">
      <view class="cart-item" wx:for="{{cart}}" wx:key="id">
        <view class="item-image">
          <image src="{{item.image}}" mode="aspectFill"></image>
        </view>
        <view class="item-info">
          <view class="item-name">{{item.name}}</view>
          <view class="item-price">Â¥{{item.price}}</view>
        </view>
        <view class="item-controls">
          <button 
            class="quantity-btn decrease"
            data-id="{{item.id}}"
            bindtap="decreaseQuantity">
            -
          </button>
          <view class="quantity">{{item.quantity}}</view>
          <button 
            class="quantity-btn increase"
            data-id="{{item.id}}"
            bindtap="increaseQuantity">
            +
          </button>
        </view>
        <view class="item-total">Â¥{{item.price * item.quantity}}</view>
      </view>
    </scroll-view>

    <!-- è´­ç‰©è½¦åº•éƒ¨ -->
    <view class="cart-footer">
      <view class="total-info">
        <view class="total-text">åˆè®¡ï¼š</view>
        <view class="total-amount">Â¥{{totalAmount}}</view>
      </view>
      <button class="submit-btn" bindtap="submitOrder">
        æäº¤è®¢å•
      </button>
    </view>
  </view>
</view>